---
layout: posts
title: "Purging Phylogenetic Redundancy"
date: 2022-07-29
excerpt: "Subsetting a phylogeny non-randomly based on genetic distance."
---

## Introduction

Large phylogenies with many tips can lead to downstream bottlenecks in computation, analysis, and visualization. I was recently working to extract data from a very large whole-genome alignment produced by the [Zoonomia Consortium](https://zoonomiaproject.org/). The original alignment data are described in [this paper](https://www.nature.com/articles/s41586-020-2876-6), were created using the [Progressive Cactus](https://github.com/ComparativeGenomicsToolkit/cactus) method described in [this paper](https://www.nature.com/articles/s41586-020-2871-y), and are available online from [this webpage](https://cglgenomics.ucsc.edu/data/cactus/). Specifically, I was using the very large 605-way combined mammalian and avian alignment HAL file for some comparative genomics work I am doing. A really nice feature of the new Cactus method of aligning and the HAL format is the phylogenetic framework that the genomic data are incorporated into. 

While not as large as other phylogenies, a 605-tip tree is pretty large and extracting alignment data from the HAL file for all of these species has a very large computational burden. Specifically, I have been working on estimating a neutral-rates phylogeny for the species included in this tree so I could attempt to identify genomic loci with various patterns of evolutionary conservation in specific lineages of mammals or birds. However, performing this task on the full alignment of all species has not been possible for me, so I was interested in reducing my list of species so this process would be more computationally manageable. However, I do not want to simply remove tips randomly from the tree since this could result in a biased representation of mammalian/avian diversity and evolution that would make the resulting inference of neutral rates problematic, potentially leading to biased results.

Ideally, one subsets the tree in a non-random way instead, resulting in a smaller tree that still encompasses major lineages in the phylogeny that can be used to produce a non-biased inference of neutral rates of evolution across mammals and birds. The idea here is to prioritize long branches representing larger amounts of evolutionary distance, and thus "uniqueness", over shorter branches that simply fill in greater amounts of diversity within a lineage of organisms that are more closely related and probably more biologically similar. Hopefully, this makes intuitive sense. 

I could always manually produce a subsetted phylogeny based on my own knowledge and opinions of mammal and bird diversity by, say, taking a random representative species for each family. However, this could also lead to biases and it ends up being time consuming, so I was really interested in an automated way of reducing redundancy in my phylogeny in a non-biased way. This seemed like a simple task and I anticipated there would be some tools to perform this subsetting but, unfortunately, I had little luck finding anything. If anyone is aware of something I missed, please let me know, but the only tool I found that did what I envisioned is called [Treemer](https://github.com/fmenardo/Treemmer), which is published [here](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-018-2164-8). What Treemer attempts to do is to subset a phylogeny by identifying the pairs of tips that have the smallest evolutionary distance and randomly removing one of those tips. Performing this process iteratively allows one to subset the phylogeny while maintaining the more diverged/unique taxa and, thus, a more realistic representation of all diversity in the dataset.

While Treemer seemed to be what I wanted, I quickly noticed that the documentation is minimal. I saw there were dependencies, but it would have been up to me to look into how to install these properly. I guess I'm lazy because this proved to be too much for me - a lesson in ensuring your software is well documented if you wish for others to use it! Given the subsetting task seemed pretty easy and intuitive, I decided to implement the approach myself. It turned out to be pretty straight-forward, and I document how I did this below.
